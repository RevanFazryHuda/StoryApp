/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={56:(t,e,r)=>{t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function r(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function n(t,n){for(var i={},a=[],u=0;u<t.length;u++){var s=t[u],c=n.base?s[0]+n.base:s[0],l=i[c]||0,f="".concat(c," ").concat(l);i[c]=l+1;var h=r(f),p={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var v=o(p,n);n.byIndex=u,e.splice(u,0,{identifier:f,updater:v,references:1})}a.push(f)}return a}function o(t,e){var r=e.domAPI(e);return r.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,o){var i=n(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var u=r(i[a]);e[u].references--}for(var s=n(t,o),c=0;c<i.length;c++){var l=r(i[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}i=s}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},177:(t,e,r)=>{r.d(e,{A:()=>u});var n=r(601),o=r.n(n),i=r(314),a=r.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};",""]);const u=a},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var u=0;u<this.length;u++){var s=this[u][0];null!=s&&(a[s]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);n&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nc=void 0;var n={};r.r(n),r.d(n,{fetchAllStories:()=>Pt,getAuthToken:()=>_t,getMapConfig:()=>Lt,getOfflineStories:()=>jt,isMapConfigValid:()=>It});var o={};r.r(o),r.d(o,{addStory:()=>fe,addStoryGuest:()=>pe,getAuthToken:()=>ce,getMapConfig:()=>ge,isMapConfigValid:()=>me,searchLocation:()=>ye});var i={};r.r(i),r.d(i,{fetchStoryDetail:()=>sr,getAuthToken:()=>ar,getMapConfig:()=>lr,isMapConfigValid:()=>fr});var a={};r.r(a),r.d(a,{getAuthToken:()=>Hr,loginUser:()=>Br,storeUserData:()=>Rr});var u={};function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(e,r,n,o){var i=r&&r.prototype instanceof v?r:v,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=x(u,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new P(o||[])),!0),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function v(){}function y(){}function d(){}var g={};l(g,i,(function(){return this}));var m=Object.getPrototypeOf,w=m&&m(m(O([])));w&&w!==r&&n.call(w,i)&&(g=w);var b=d.prototype=v.prototype=Object.create(g);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==s(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=h(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function P(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function O(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(s(e)+" is not iterable")}return y.prototype=d,l(b,"constructor",d),l(d,"constructor",y),y.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,l(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},k(E.prototype),l(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(b),l(b,u,"Generator"),l(b,i,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:O(e),r,n},"next"===this.method&&(this.arg=t),p}},e}function l(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,u,"next",t)}function u(t){l(i,n,o,a,u,"throw",t)}a(void 0)}))}}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}r.r(u),r.d(u,{getAuthToken:()=>pn,registerUser:()=>yn});var v=function(){return t=function t(e){var r=e.view,n=e.homeModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._homeModel=n,this._stories=[]},e=[{key:"getViewTemplate",value:function(){return this._view.getTemplate()}},{key:"init",value:(n=f(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showStories();case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showStories",value:(r=f(c().mark((function t(){var e,r,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,this._homeModel.getAuthToken();case 4:if(e=t.sent){t.next=10;break}return console.log("Token autentikasi tidak ditemukan, mengarahkan ke login"),this._view.showLoginRequiredMessage(),this._redirectToLoginWithDelay(2e3),t.abrupt("return");case 10:return console.log("Mengambil cerita dengan token"),t.next=13,this._homeModel.fetchAllStories(e,1);case 13:if((r=t.sent).error){t.next=27;break}if(this._stories=(r.listStory||[]).filter((function(t){var e=Number(t.lat),r=Number(t.lon),n=!isNaN(e)&&!isNaN(r)&&e>=-90&&e<=90&&r>=-180&&r<=180;return n||console.warn("Menyaring cerita ".concat(t.id," karena koordinat tidak valid: lat=").concat(t.lat,", lon=").concat(t.lon)),n})),console.log("Cerita yang valid:",this._stories.map((function(t){return{id:t.id,lat:t.lat,lon:t.lon}}))),0!==this._stories.length||navigator.onLine){t.next=24;break}return t.next=20,this._homeModel.getOfflineStories();case 20:this._stories=t.sent,0===this._stories.length?this._view.showEmptyStories():(this._view.showStories(this._stories),this._view.showOfflineMessage(),this._renderMapsForStories()),t.next=25;break;case 24:0===this._stories.length?this._view.showEmptyStories():(this._view.showStories(this._stories),this._renderMapsForStories());case 25:t.next=41;break;case 27:if(console.error("API mengembalikan error:",r.message),!(null!==(n=r.message)&&void 0!==n&&n.toLowerCase().includes("token")||401===r.status)){t.next=33;break}this._view.showError("Sesi Anda telah berakhir. Silakan login kembali."),this._redirectToLoginWithDelay(2e3),t.next=41;break;case 33:if(navigator.onLine){t.next=40;break}return t.next=36,this._homeModel.getOfflineStories();case 36:this._stories=t.sent,0===this._stories.length?this._view.showEmptyStories():(this._view.showStories(this._stories),this._view.showOfflineMessage(),this._renderMapsForStories()),t.next=41;break;case 40:this._view.showError(r.message||"Gagal memuat cerita");case 41:t.next=54;break;case 43:if(t.prev=43,t.t0=t.catch(0),console.error("Error di showStories:",t.t0),navigator.onLine&&!t.t0.message.includes("Failed to fetch")&&!t.t0.message.includes("net::ERR_FAILED")){t.next=53;break}return t.next=49,this._homeModel.getOfflineStories();case 49:this._stories=t.sent,0===this._stories.length?this._view.showEmptyStories():(this._view.showStories(this._stories),this._view.showOfflineMessage(),navigator.onLine&&this._renderMapsForStories()),t.next=54;break;case 53:this._view.showError(t.t0.message||"Terjadi kesalahan saat memuat cerita");case 54:return t.prev=54,this._view.hideLoading(),t.finish(54);case 57:case"end":return t.stop()}}),t,this,[[0,43,54,57]])}))),function(){return r.apply(this,arguments)})},{key:"_renderMapsForStories",value:function(){var t=this;this._isMapLibraryAvailable()?this._homeModel.isMapConfigValid()?this._stories.forEach((function(e){var r=Number(e.lat),n=Number(e.lon);!isNaN(r)&&!isNaN(n)&&r>=-90&&r<=90&&n>=-180&&n<=180?setTimeout((function(){var o=t._homeModel.getMapConfig();console.log("Merender peta untuk story ".concat(e.id,": lat=").concat(r,", lon=").concat(n)),t._view.renderMap(e.id,r,n,o)}),100):console.warn("Koordinat tidak valid untuk story ".concat(e.id,": lat=").concat(e.lat,", lon=").concat(e.lon))})):console.warn("Konfigurasi peta tidak lengkap"):console.warn("MapLibre GL JS tidak tersedia")}},{key:"_isMapLibraryAvailable",value:function(){return"undefined"!=typeof maplibregl}},{key:"_redirectToLoginWithDelay",value:function(t){this._view.redirectWithDelay(t)}}],e&&h(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const y=v;function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t,e,r){return(e=function(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id-ID",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},r))}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t){if("object"!=b(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:e+""}function x(t){var e="function"==typeof Map?new Map:void 0;return x=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(_())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&S(o,r.prototype),o}(t,arguments,P(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),S(r,t)},x(t)}function _(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_=function(){return!!t})()}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var O=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=P(e),function(t,e){if(e&&("object"==b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_()?Reflect.construct(e,r||[],P(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(e,t),r=e,n=[{key:"story",set:function(t){this._story=t,this.render()}},{key:"render",value:function(){var t=this;this.innerHTML='\n      <article class="story-item">\n        <img src="'.concat(this._story.photoUrl,'" alt="').concat(this._story.name?this._story.name+"'s story":"User's story",'" class="story-image">\n        <div class="story-content">\n          <h3 class="story-title">').concat(this._story.name,'</h3>\n          <p class="story-description">').concat(this._truncateDescription(this._story.description),'</p>\n          <p class="story-date">').concat(w(this._story.createdAt),'</p>\n          <a href="/detail/').concat(this._story.id,'" class="read-more-button">Baca Selengkapnya</a>\n        </div>\n        ').concat(this._story.lat&&this._story.lon?'\n          <div class="story-map" id="map-'.concat(this._story.id,'" data-lat="').concat(this._story.lat,'" data-lon="').concat(this._story.lon,'"></div>\n        '):"","\n      </article>\n    "),this.querySelector(".story-item").addEventListener("click",(function(e){"A"!==e.target.tagName&&(window.location.href="/detail/".concat(t._story.id))}))}},{key:"_truncateDescription",value:function(t){return t.length>100?t.substring(0,100)+"...":t}}],n&&k(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(x(HTMLElement));function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function L(t){var e=function(t){if("object"!=j(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==j(e)?e:e+""}customElements.get("story-item")||customElements.define("story-item",O);const I=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getTemplate",value:function(){return'\n      <section class="stories-section">\n        <h2 class="section-title">Cerita Terbaru</h2>\n        <div class="stories-container" id="stories-container"></div>\n        <div class="loading-container" id="loading-container"></div>\n        <div id="error-message" class="error-message"></div>\n        <div id="offline-message" class="info-message" style="display: none;">Mode Offline: Menampilkan cerita tersimpan</div>\n      </section>\n    '}},{key:"showStories",value:function(t){var e=document.getElementById("stories-container");e?(e.innerHTML="",0!==t.length?t.forEach((function(t){try{var r=document.createElement("story-item");r.story=t,e.appendChild(r)}catch(t){console.error("Error rendering story item:",t)}})):this.showEmptyStories()):console.error("Stories container tidak ditemukan di DOM")}},{key:"showOfflineMessage",value:function(){var t=document.getElementById("offline-message");t&&(t.style.display="block")}},{key:"renderMap",value:function(t,e,r,n){var o=document.getElementById("map-".concat(t));if(o){if("number"!=typeof e||"number"!=typeof r||isNaN(e)||isNaN(r)||e<-90||e>90||r<-180||r>180)return console.warn("Koordinat tidak valid untuk story ".concat(t,": lat=").concat(e,", lon=").concat(r)),void(o.innerHTML='<div class="map-error">Koordinat tidak valid untuk peta</div>');try{var i=new maplibregl.Map({container:o,style:n.style,center:[r,e],zoom:10,interactive:!0});(new maplibregl.Marker).setLngLat([r,e]).setPopup((new maplibregl.Popup).setHTML("<h3>Story</h3><p>Koordinat: ".concat(e.toFixed(6),", ").concat(r.toFixed(6),"</p>"))).addTo(i),i.on("styleimagemissing",(function(t){console.log("Gambar hilang:",t.id),i.addImage(t.id,new Image(1,1))}))}catch(e){console.error("Gagal merender peta untuk story ".concat(t,":"),e),o.innerHTML='<div class="map-error">Gagal memuat peta</div>'}}else console.warn("Map container untuk story ".concat(t," tidak ditemukan"))}},{key:"showEmptyStories",value:function(){var t=document.getElementById("stories-container");t&&(t.innerHTML='<p class="empty-message">Belum ada cerita yang dibagikan.</p>')}},{key:"showLoginRequiredMessage",value:function(){var t=document.getElementById("error-message");t&&(t.textContent="Silakan login untuk melihat cerita.",t.classList.add("info-message"))}},{key:"showLoading",value:function(){var t=document.getElementById("loading-container");t&&(t.innerHTML='<div class="loading-spinner"></div>')}},{key:"hideLoading",value:function(){var t=document.getElementById("loading-container");t&&(t.innerHTML="")}},{key:"showError",value:function(t){var e,r=document.createElement("div");r.textContent=t,r.style.cssText="color: red; margin: 10px 0;",null===(e=document.getElementById("stories-container"))||void 0===e||e.prepend(r),setTimeout((function(){return r.remove()}),3e3)}},{key:"redirectToLogin",value:function(){window.location.href="/auth/login"}},{key:"redirectWithDelay",value:function(t){var e=this;setTimeout((function(){e.redirectToLogin()}),t)}}],e&&T(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),A={BASE_URL:"https://story-api.dicoding.dev/v1",MAPTILER_API_KEY:"UF8IB6hcumzoX6wsQVwE",MAP_STYLE:"https://api.maptiler.com/maps/openstreetmap/style.json?key=UF8IB6hcumzoX6wsQVwE",VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",DEFAULT_LANGUAGE:"id",CACHE_NAME:"dicoding-story-app-v1",DATABASE_NAME:"story-app-database",DATABASE_VERSION:1,OBJECT_STORE_NAME:"stories"};let G,N;const M=new WeakMap,F=new WeakMap,C=new WeakMap,B=new WeakMap,D=new WeakMap;let R={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return F.get(t);if("objectStoreNames"===e)return t.objectStoreNames||C.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return H(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function U(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(N||(N=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Y(this),t),H(M.get(this))}:function(...t){return H(e.apply(Y(this),t))}:function(t,...r){const n=e.call(Y(this),t,...r);return C.set(n,t.sort?t.sort():[t]),H(n)}:(t instanceof IDBTransaction&&function(t){if(F.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),n()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));F.set(t,e)}(t),r=t,(G||(G=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>r instanceof t))?new Proxy(t,R):t);var e,r}function H(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(H(t.result)),n()},i=()=>{r(t.error),n()};t.addEventListener("success",o),t.addEventListener("error",i)}));return e.then((e=>{e instanceof IDBCursor&&M.set(e,t)})).catch((()=>{})),D.set(e,t),e}(t);if(B.has(t))return B.get(t);const e=U(t);return e!==t&&(B.set(t,e),D.set(e,t)),e}const Y=t=>D.get(t);function V(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),u=H(a);return n&&a.addEventListener("upgradeneeded",(t=>{n(H(a.result),t.oldVersion,t.newVersion,H(a.transaction),t)})),r&&a.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),u.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),u}const K=["get","getKey","getAll","getAllKeys","count"],W=["put","add","delete","clear"],z=new Map;function J(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(z.get(e))return z.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=W.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!K.includes(r))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(e.shift())),(await Promise.all([a[r](...e),o&&i.done]))[0]};return z.set(e,i),i}function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function Q(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return X(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?X(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $(){$=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==q(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(q(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Z(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function tt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Z(i,n,o,a,u,"next",t)}function u(t){Z(i,n,o,a,u,"throw",t)}a(void 0)}))}}function et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nt(n.key),n)}}function rt(t,e,r){return(e=nt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nt(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}var ot;ot=R,R={...ot,get:(t,e,r)=>J(t,e)||ot.get(t,e,r),has:(t,e)=>!!J(t,e)||ot.has(t,e)};var it=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"initDb",value:(o=tt($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",V(A.DATABASE_NAME,A.DATABASE_VERSION,{upgrade:function(t){t.objectStoreNames.contains(A.OBJECT_STORE_NAME)||t.createObjectStore(A.OBJECT_STORE_NAME,{keyPath:"id"})}}));case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"saveStories",value:(n=tt($().mark((function t(e){var r,n,o,i,a,u;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.initDb();case 3:r=t.sent,n=r.transaction(A.OBJECT_STORE_NAME,"readwrite"),o=n.objectStore(A.OBJECT_STORE_NAME),i=Q(e),t.prev=7,i.s();case 9:if((a=i.n()).done){t.next=15;break}return u=a.value,t.next=13,o.put(u);case 13:t.next=9;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(7),i.e(t.t0);case 20:return t.prev=20,i.f(),t.finish(20);case 23:return t.next=25,n.done;case 25:return console.log("Stories saved to IndexedDB"),t.abrupt("return",!0);case 29:return t.prev=29,t.t1=t.catch(0),console.error("Error saving stories:",t.t1),t.abrupt("return",!1);case 33:case"end":return t.stop()}}),t,this,[[0,29],[7,17,20,23]])}))),function(t){return n.apply(this,arguments)})},{key:"getAllStories",value:(r=tt($().mark((function t(){var e,r,n,o;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.initDb();case 3:return e=t.sent,r=e.transaction(A.OBJECT_STORE_NAME,"readonly"),n=r.objectStore(A.OBJECT_STORE_NAME),t.next=8,n.getAll();case 8:return o=t.sent,console.log("Retrieved stories from IndexedDB:",o),t.abrupt("return",o);case 13:return t.prev=13,t.t0=t.catch(0),console.error("Error getting stories:",t.t0),t.abrupt("return",[]);case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(){return r.apply(this,arguments)})},{key:"saveToken",value:function(t){try{return localStorage.setItem(this.TOKEN_KEY,t),!0}catch(t){return console.error("Error saving token:",t),!1}}},{key:"getToken",value:function(){try{return localStorage.getItem(this.TOKEN_KEY)}catch(t){return console.error("Error getting token:",t),null}}},{key:"removeToken",value:function(){try{return localStorage.removeItem(this.TOKEN_KEY),!0}catch(t){return console.error("Error removing token:",t),!1}}},{key:"saveUser",value:function(t){try{return localStorage.setItem(this.USER_KEY,JSON.stringify(t)),!0}catch(t){return console.error("Error saving user:",t),!1}}},{key:"getUser",value:function(){try{var t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Error getting user:",t),null}}},{key:"removeUser",value:function(){try{return localStorage.removeItem(this.USER_KEY),!0}catch(t){return console.error("Error removing user:",t),!1}}}],e&&et(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();rt(it,"TOKEN_KEY","dicoding_story_token"),rt(it,"USER_KEY","dicoding_story_user");const at=it;function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function st(){st=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==ut(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ut(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ct(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function lt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ct(i,n,o,a,u,"next",t)}function u(t){ct(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t){if("object"!=ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(e)?e:e+""}var pt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAllStories",value:(u=lt(st().mark((function t(e){var r,n,o,i,a=arguments;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:0,t.prev=1,t.next=4,fetch("".concat(A.BASE_URL,"/stories?location=").concat(r),{headers:{Authorization:"Bearer ".concat(e)}});case 4:if((n=t.sent).ok){t.next=7;break}throw new Error("HTTP error! status: ".concat(n.status));case 7:return t.next=9,n.json();case 9:if((o=t.sent).error||!o.listStory){t.next=13;break}return t.next=13,at.saveStories(o.listStory);case 13:return t.abrupt("return",o);case 16:if(t.prev=16,t.t0=t.catch(1),console.error("Error fetching stories:",t.t0),navigator.onLine&&!t.t0.message.includes("Failed to fetch")&&!t.t0.message.includes("net::ERR_FAILED")&&"TypeError"!==t.t0.name){t.next=25;break}return console.log("Offline mode: Fetching stories from IndexedDB"),t.next=23,at.getAllStories();case 23:return i=t.sent,t.abrupt("return",{error:!1,listStory:i||[]});case 25:throw new Error("Gagal memuat cerita dari server: "+t.t0.message);case 26:case"end":return t.stop()}}),t,null,[[1,16]])}))),function(t){return u.apply(this,arguments)})},{key:"register",value:(a=lt(st().mark((function t(e){var r,n,o,i;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,n=e.email,o=e.password,t.next=3,fetch("".concat(A.BASE_URL,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:n,password:o})});case 3:return i=t.sent,t.abrupt("return",i.json());case 5:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"login",value:(i=lt(st().mark((function t(e){var r,n,o;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,t.next=3,fetch("".concat(A.BASE_URL,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:n})});case 3:return o=t.sent,t.abrupt("return",o.json());case 5:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"getStoryDetail",value:(o=lt(st().mark((function t(e,r){var n;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(A.BASE_URL,"/stories/").concat(r),{headers:{Authorization:"Bearer ".concat(e)}});case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})},{key:"addStory",value:function(){var t=lt(st().mark((function t(e,r){var n,o,i,a,u,s,c,l,f;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.description,o=r.photo,i=r.lat,a=r.lon,(u=new FormData).append("description",n),u.append("photo",o),i&&a&&(u.append("lat",i),u.append("lon",a)),s=new AbortController,c=setTimeout((function(){return s.abort()}),1e4),t.prev=7,t.next=10,fetch("".concat(A.BASE_URL,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:u,signal:s.signal});case 10:if(l=t.sent,clearTimeout(c),l.ok){t.next=17;break}return t.next=15,l.json().catch((function(){return{}}));case 15:throw f=t.sent,new Error(f.message||"Failed to add story: HTTP ".concat(l.status));case 17:return t.next=19,l.json();case 19:return t.abrupt("return",t.sent);case 22:throw t.prev=22,t.t0=t.catch(7),clearTimeout(c),t.t0;case 26:case"end":return t.stop()}}),t,null,[[7,22]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"addStoryGuest",value:function(){var t=lt(st().mark((function t(e){var r,n,o,i,a,u,s,c,l;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.description,n=e.photo,o=e.lat,i=e.lon,(a=new FormData).append("description",r),a.append("photo",n),o&&i&&(a.append("lat",o),a.append("lon",i)),u=new AbortController,s=setTimeout((function(){return u.abort()}),1e4),t.prev=7,t.next=10,fetch("".concat(A.BASE_URL,"/stories/guest"),{method:"POST",body:a,signal:u.signal});case 10:if(c=t.sent,clearTimeout(s),c.ok){t.next=17;break}return t.next=15,c.json().catch((function(){return{}}));case 15:throw l=t.sent,new Error(l.message||"Failed to add story as guest: HTTP ".concat(c.status));case 17:return t.next=19,c.json();case 19:return t.abrupt("return",t.sent);case 22:throw t.prev=22,t.t0=t.catch(7),clearTimeout(s),t.t0;case 26:case"end":return t.stop()}}),t,null,[[7,22]])})));return function(e){return t.apply(this,arguments)}}()},{key:"searchLocation",value:function(){var t=lt(st().mark((function t(e){var r;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.trim()){t.next=2;break}throw new Error("Masukkan nama lokasi untuk mencari");case 2:return t.next=4,fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e)));case 4:return r=t.sent,t.abrupt("return",r.json());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"subscribePushNotification",value:(n=lt(st().mark((function t(e,r){var n,o,i,a;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new AbortController,o=setTimeout((function(){return n.abort()}),1e4),t.prev=2,t.next=5,fetch("".concat(A.BASE_URL,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(r),signal:n.signal});case 5:return i=t.sent,clearTimeout(o),t.next=9,i.json();case 9:if(a=t.sent,i.ok){t.next=12;break}throw new Error(a.message||"Gagal berlangganan: HTTP ".concat(i.status));case 12:return t.abrupt("return",a);case 15:throw t.prev=15,t.t0=t.catch(2),clearTimeout(o),new Error("Gagal berlangganan notifikasi: ".concat(t.t0.message));case 19:case"end":return t.stop()}}),t,null,[[2,15]])}))),function(t,e){return n.apply(this,arguments)})},{key:"unsubscribePushNotification",value:(r=lt(st().mark((function t(e,r){var n;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(A.BASE_URL,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({endpoint:r})});case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})}],e&&ft(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u}();const vt=pt;function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function gt(t){var e=function(t){if("object"!=yt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yt(e)?e:e+""}var mt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"saveToken",value:function(t){at.saveToken(t)}},{key:"getToken",value:function(){return at.getToken()}},{key:"removeToken",value:function(){at.removeToken()}},{key:"saveUser",value:function(t){at.saveUser(t)}},{key:"getUser",value:function(){return at.getUser()}},{key:"removeUser",value:function(){at.removeUser()}},{key:"logout",value:function(){this.removeToken(),this.removeUser()}},{key:"isAuthenticated",value:function(){return!!this.getToken()}}],null&&dt(t.prototype,null),e&&dt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const wt=mt;function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function kt(){kt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==bt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(bt(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Et(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Et(i,n,o,a,u,"next",t)}function u(t){Et(i,n,o,a,u,"throw",t)}a(void 0)}))}}function _t(){return St.apply(this,arguments)}function St(){return(St=xt(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",wt.getToken());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pt(t){return Ot.apply(this,arguments)}function Ot(){return Ot=xt(kt().mark((function t(e){var r,n=arguments;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:1,t.next=3,vt.getAllStories(e,r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),Ot.apply(this,arguments)}function jt(){return Tt.apply(this,arguments)}function Tt(){return(Tt=xt(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,at.getAllStories();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lt(){return{style:A.MAP_STYLE.replace("UF8IB6hcumzoX6wsQVwE",A.MAPTILER_API_KEY)}}function It(){return A.MAP_STYLE&&A.MAPTILER_API_KEY}function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Gt(){Gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==At(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(At(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Nt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Mt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Nt(i,n,o,a,u,"next",t)}function u(t){Nt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ct(n.key),n)}}function Ct(t){var e=function(t){if("object"!=At(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}const Bt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new I,this._presenter=new y({view:this._view,homeModel:n})},e=[{key:"render",value:(o=Mt(Gt().mark((function t(){return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._presenter.getViewTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(r=Mt(Gt().mark((function t(){return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._presenter.init();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,o}();function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Rt(){Rt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Dt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Dt(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ut(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ht(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ut(i,n,o,a,u,"next",t)}function u(t){Ut(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vt(n.key),n)}}function Vt(t){var e=function(t){if("object"!=Dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}var Kt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),console.log("AboutPage constructor called")},e=[{key:"render",value:(n=Ht(Rt().mark((function t(){return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("AboutPage render called"),t.abrupt("return",this.getTemplate());case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getTemplate",value:function(){return console.log("AboutPage getTemplate called"),'\n      <section class="about-section">\n        <div class="about-container">\n          <h1 class="about-title">Tentang Aplikasi</h1>\n          <div class="about-content">\n            <p>Aplikasi Dicoding Story adalah platform untuk berbagi cerita seputar pengalaman belajar di Dicoding.</p>\n            <p>Dengan aplikasi ini, Anda dapat:</p>\n            <ul>\n              <li>Membaca cerita dari pengguna lain</li>\n              <li>Membagikan cerita dan pengalaman belajar Anda</li>\n              <li>Melampirkan foto dan lokasi</li>\n              <li>Mendapatkan notifikasi ketika cerita Anda dipublikasikan</li>\n            </ul>\n            <p>Aplikasi ini dibangun dengan:</p>\n            <ul>\n              <li>JavaScript ES6+</li>\n              <li>Web Components</li>\n              <li>Single Page Application Architecture</li>\n              <li>Model-View-Presenter Pattern</li>\n            </ul>\n          </div>\n        </div>\n      </section>\n    '}},{key:"afterRender",value:(r=Ht(Rt().mark((function t(){return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("AboutPage afterRender called");case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Yt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();console.log("AboutPage module loaded");const Wt=Kt;function zt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=new maplibregl.Marker(n).setLngLat(e).addTo(t);if(r){var i=(new maplibregl.Popup).setHTML(r);o.setPopup(i)}return o}function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function qt(){qt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Jt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Jt(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Qt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var Xt=function(){var t,e=(t=qt().mark((function t(){var e,r=arguments;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.length>0&&void 0!==r[0]?r[0]:{video:!0,audio:!1},navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){t.next=3;break}throw new Error("Browser Anda tidak mendukung akses kamera. Silakan gunakan browser modern seperti Chrome, Firefox, atau Edge terbaru.");case 3:return t.prev=3,t.next=6,navigator.mediaDevices.getUserMedia(e);case 6:case 20:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(3),t.t1=t.t0.name,t.next="NotFoundError"===t.t1||"DevicesNotFoundError"===t.t1?14:"NotAllowedError"===t.t1||"PermissionDeniedError"===t.t1?15:"NotReadableError"===t.t1||"TrackStartError"===t.t1?16:"OverconstrainedError"===t.t1||"ConstraintNotSatisfiedError"===t.t1?17:21;break;case 14:throw new Error("Tidak dapat menemukan kamera. Pastikan perangkat Anda memiliki kamera yang terhubung.");case 15:throw new Error("Akses kamera ditolak. Silakan berikan izin untuk menggunakan kamera di pengaturan browser Anda.");case 16:throw new Error("Kamera tidak dapat diakses. Ini mungkin karena kamera sedang digunakan oleh aplikasi lain atau mengalami masalah hardware.");case 17:return console.log("Mencoba dengan constraint kamera yang lebih sederhana"),t.next=20,navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:640},height:{ideal:480}},audio:!1});case 21:throw new Error("Terjadi kesalahan saat mengakses kamera: ".concat(t.t0.message));case 22:case"end":return t.stop()}}),t,null,[[3,9]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Qt(i,n,o,a,u,"next",t)}function u(t){Qt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Zt(){Zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==$t(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError($t(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function te(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ee(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){te(i,n,o,a,u,"next",t)}function u(t){te(i,n,o,a,u,"throw",t)}a(void 0)}))}}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ne(n.key),n)}}function ne(t){var e=function(t){if("object"!=$t(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$t(e)?e:e+""}const oe=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._elements={},this._map=null,this._marker=null},e=[{key:"getTemplate",value:function(){return'\n      <section class="add-section">\n        <h2 class="section-title">Tambah Story Baru</h2>\n        <form id="add-story-form" class="add-form">\n          <div class="form-row">\n            <label for="description">Deskripsi</label>\n            <textarea id="description" required></textarea>\n          </div>\n          \n          <div class="camera-container">\n            <label>Foto</label>\n            <div class="camera-preview">\n              <video id="camera-preview" playsinline autoplay muted></video>\n              <img id="photo-preview" style="display: none;">\n              <canvas id="canvas" style="display: none;"></canvas>\n            </div>\n            <div class="camera-controls">\n              <button type="button" id="capture-button" class="capture-button">Buka Kamera</button>\n              <button type="button" id="retake-button" class="capture-button" style="display: none;">Ambil Ulang</button>\n              <button type="button" id="capture-photo" class="capture-button" style="display: none;">Ambil Foto</button>\n            </div>\n            <div id="camera-status" class="camera-status"></div>\n          </div>\n          \n          <div class="form-row">\n            <label for="location-toggle">Tambahkan Lokasi</label>\n            <input type="checkbox" id="location-toggle">\n            \n            <div id="location-options" class="location-options" style="display: none; margin-top: 10px;">\n              <div class="location-type-selector">\n                <label for="location-type-auto">Gunakan lokasi saat ini</label>\n                <input type="radio" name="location-type" id="location-type-auto" value="auto" checked>\n                <label for="location-type-manual">Pilih lokasi di peta</label>\n                <input type="radio" name="location-type" id="location-type-manual" value="manual">\n              </div>\n              \n              <div class="location-search" style="margin-top: 10px;">\n                <label for="location-search-input" class="visually-hidden">Cari lokasi</label>\n                <input type="text" id="location-search-input" placeholder="Cari lokasi..." style="width: 100%; padding: 8px; margin-bottom: 10px;">\n                <button type="button" id="location-search-button" class="search-button">Cari</button>\n              </div>\n              \n              <div class="coordinates-display" style="margin-top: 5px; font-size: 0.9em;">\n                <span>Koordinat: </span>\n                <span id="coordinates-display">-</span>\n              </div>\n            </div>\n            \n            <input type="hidden" id="lat">\n            <input type="hidden" id="lon">\n            <div id="map-picker" class="story-map" style="display: none; height: 300px;"></div>\n          </div>\n          \n          <button type="submit" class="submit-button">Simpan Story</button>\n        </form>\n        <div id="loading-container" class="loading-container"></div>\n        <div id="error-message" class="error-message"></div>\n      </section>\n    '}},{key:"initElements",value:function(){this._elements.captureButton=document.getElementById("capture-button"),this._elements.retakeButton=document.getElementById("retake-button"),this._elements.capturePhotoButton=document.getElementById("capture-photo"),this._elements.videoElement=document.getElementById("camera-preview"),this._elements.canvasElement=document.getElementById("canvas"),this._elements.photoPreview=document.getElementById("photo-preview"),this._elements.form=document.getElementById("add-story-form"),this._elements.description=document.getElementById("description"),this._elements.mapContainer=document.getElementById("map-picker"),this._elements.latInput=document.getElementById("lat"),this._elements.lonInput=document.getElementById("lon"),this._elements.locationToggle=document.getElementById("location-toggle"),this._elements.locationOptions=document.getElementById("location-options"),this._elements.locationTypeAuto=document.getElementById("location-type-auto"),this._elements.locationTypeManual=document.getElementById("location-type-manual"),this._elements.locationSearchInput=document.getElementById("location-search-input"),this._elements.locationSearchButton=document.getElementById("location-search-button"),this._elements.coordinatesDisplay=document.getElementById("coordinates-display")}},{key:"startCamera",value:(o=ee(Zt().mark((function t(){var e;return Zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.showCameraStatus("Meminta akses kamera..."),this.showLoading(),t.next=5,Xt({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}},audio:!1});case 5:return e=t.sent,t.next=8,this.setVideoStream(e);case 8:return this.showCameraPreview(),this.showCameraStatus("Kamera siap digunakan"),t.abrupt("return",e);case 13:throw t.prev=13,t.t0=t.catch(0),this.showError("Tidak dapat mengakses kamera: ".concat(t.t0.message)),this.showCameraStatus("Gagal mengakses kamera: ".concat(t.t0.message),!0),t.t0;case 18:return t.prev=18,this.hideLoading(),t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[0,13,18,21]])}))),function(){return o.apply(this,arguments)})},{key:"capturePhoto",value:(n=ee(Zt().mark((function t(){var e,r,n,o,i,a=this;return Zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=this.getVideoElement(),r=this.getCanvasElement(),n=this.getCanvasContext(),o=e.videoWidth||640,i=e.videoHeight||480,this.setCanvasDimensions(o,i),n.drawImage(e,0,0,o,i),t.abrupt("return",new Promise((function(t){r.toBlob((function(e){if(!e)throw new Error("Gagal membuat blob gambar");var r=URL.createObjectURL(e);a.showPhotoPreview(r),a.showCameraStatus("Foto berhasil diambil"),t(new File([e],"photo.jpg",{type:"image/jpeg"}))}),"image/jpeg",.9)})));case 11:throw t.prev=11,t.t0=t.catch(0),this.showError("Gagal mengambil foto: ".concat(t.t0.message)),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return n.apply(this,arguments)})},{key:"stopCameraStream",value:function(t){t&&t.getTracks().forEach((function(t){t.stop(),console.log("Camera track stopped:",t.label)}))}},{key:"showCameraPreview",value:function(){this._elements.videoElement.style.display="block",this._elements.photoPreview.style.display="none",this._elements.captureButton.style.display="none",this._elements.capturePhotoButton.style.display="block",this._elements.retakeButton.style.display="none"}},{key:"showPhotoPreview",value:function(t){this._elements.photoPreview.src=t,this._elements.videoElement.style.display="none",this._elements.photoPreview.style.display="block",this._elements.captureButton.style.display="block",this._elements.capturePhotoButton.style.display="none",this._elements.retakeButton.style.display="block"}},{key:"resetPhoto",value:function(){this._elements.photoPreview.src="",this._elements.photoPreview.style.display="none"}},{key:"setVideoStream",value:function(t){return this._elements.videoElement.srcObject=t,this._elements.videoElement.play()}},{key:"getVideoElement",value:function(){return this._elements.videoElement}},{key:"getCanvasElement",value:function(){return this._elements.canvasElement}},{key:"getCanvasContext",value:function(){return this._elements.canvasElement.getContext("2d")}},{key:"setCanvasDimensions",value:function(t,e){this._elements.canvasElement.width=t,this._elements.canvasElement.height=e}},{key:"getDescriptionValue",value:function(){return this._elements.description.value}},{key:"initMap",value:function(t){var e=this;if(this._isMapLibraryAvailable()){var r=this.getMapContainer(),n=[106.8272,-6.1754];this._map=new maplibregl.Map({container:r,style:t.style,center:n,zoom:12}),this._map.addControl(new maplibregl.NavigationControl,"top-right"),this._map.addControl(new maplibregl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right"),this._marker=zt(this._map,n,"<h3>Lokasi</h3><p>Koordinat: ".concat(n[1].toFixed(6),", ").concat(n[0].toFixed(6),"</p>"),{draggable:!0}),this._map.on("styleimagemissing",(function(t){console.log("Missing image:",t.id),e._map.addImage(t.id,new Image(1,1))}))}else console.warn("MapLibre GL JS is not available")}},{key:"bindMapEvents",value:function(t){var e=this;this._map&&this._marker&&(this._marker.on("dragend",(function(){var r=e._marker.getLngLat();t(r.lat,r.lng),e.updateMapPopup(r.lat,r.lng)})),this._map.on("click",(function(r){e._elements.locationTypeManual.checked&&(e._marker.setLngLat(r.lngLat),t(r.lngLat.lat,r.lngLat.lng),e.updateMapPopup(r.lngLat.lat,r.lngLat.lng))})))}},{key:"updateMapPopup",value:function(t,e){this._marker&&this._marker.getPopup().setHTML("<h3>Lokasi</h3><p>Koordinat: ".concat(t.toFixed(6),", ").concat(e.toFixed(6),"</p>"))}},{key:"updateMapPosition",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14;this._map&&this._marker&&(this._map.flyTo({center:[e,t],zoom:r}),this._marker.setLngLat([e,t]),this.updateMapPopup(t,e))}},{key:"getCurrentLocation",value:(r=ee(Zt().mark((function t(){var e=this;return Zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showLoading(),t.abrupt("return",new Promise((function(t,r){navigator.geolocation.getCurrentPosition((function(r){var n=r.coords,o=n.latitude,i=n.longitude;e.updateMapPosition(o,i),e.hideLoading(),t({lat:o,lon:i})}),(function(t){console.error("Error getting current location:",t),e.showError("Tidak dapat mengakses lokasi: ".concat(t.message)),e.hideLoading(),r(t)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_isMapLibraryAvailable",value:function(){return"undefined"!=typeof maplibregl}},{key:"getMapContainer",value:function(){return this._elements.mapContainer}},{key:"bindCaptureButtonClick",value:function(t){this._elements.captureButton.addEventListener("click",t)}},{key:"bindRetakeButtonClick",value:function(t){this._elements.retakeButton.addEventListener("click",t)}},{key:"bindCapturePhotoButtonClick",value:function(t){this._elements.capturePhotoButton.addEventListener("click",t)}},{key:"bindFormSubmit",value:function(t){this._elements.form.addEventListener("submit",t)}},{key:"bindLocationToggleChange",value:function(t){this._elements.locationToggle.addEventListener("change",t)}},{key:"bindLocationTypeAutoChange",value:function(t){this._elements.locationTypeAuto.addEventListener("change",t)}},{key:"bindLocationSearchButtonClick",value:function(t){this._elements.locationSearchButton.addEventListener("click",t)}},{key:"bindLocationSearchInputKeypress",value:function(t){this._elements.locationSearchInput.addEventListener("keypress",t)}},{key:"getLocationSearchQuery",value:function(){return this._elements.locationSearchInput.value}},{key:"updateCoordinatesDisplay",value:function(t,e){this._elements.coordinatesDisplay.textContent="".concat(t.toFixed(6),", ").concat(e.toFixed(6))}},{key:"updateLocationInputs",value:function(t,e){this._elements.latInput.value=t,this._elements.lonInput.value=e}},{key:"showLocationOptions",value:function(){var t=this;this._elements.locationOptions.style.display="block",this._elements.mapContainer.style.display="block",this._map&&setTimeout((function(){return t._map.resize()}),100)}},{key:"hideLocationOptions",value:function(){this._elements.locationOptions.style.display="none",this._elements.mapContainer.style.display="none",this.updateLocationInputs("","")}},{key:"showLoading",value:function(){document.getElementById("loading-container").innerHTML='<div class="loading-spinner"></div>'}},{key:"hideLoading",value:function(){var t=document.getElementById("loading-container");t?t.innerHTML="":console.error("Loading container not found")}},{key:"showError",value:function(t){var e=document.getElementById("error-message");e.textContent=t,e.style.display="block",setTimeout((function(){e.style.display="none"}),5e3)}},{key:"showCameraStatus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=document.getElementById("camera-status");r&&(r.textContent=t,r.className="camera-status"+(e?" error":""),r.style.display="block",e||setTimeout((function(){r.style.display="none"}),3e3))}},{key:"redirectToHome",value:function(){window.location.href="/"}}],e&&re(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function ie(t){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(t)}function ae(){ae=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==ie(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ie(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ue(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function se(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ue(i,n,o,a,u,"next",t)}function u(t){ue(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ce(){return le.apply(this,arguments)}function le(){return(le=se(ae().mark((function t(){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",wt.getToken());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function fe(t,e){return he.apply(this,arguments)}function he(){return he=se(ae().mark((function t(e,r){var n,o,i,a;return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.description,o=r.photo,i=r.lat,a=r.lon,t.next=3,vt.addStory(e,{description:n,photo:o,lat:i,lon:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),he.apply(this,arguments)}function pe(t){return ve.apply(this,arguments)}function ve(){return(ve=se(ae().mark((function t(e){var r,n,o,i;return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.description,n=e.photo,o=e.lat,i=e.lon,t.next=3,vt.addStoryGuest({description:r,photo:n,lat:o,lon:i});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ye(t){return de.apply(this,arguments)}function de(){return(de=se(ae().mark((function t(e){return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt.searchLocation(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ge(){return{style:A.MAP_STYLE.replace("UF8IB6hcumzoX6wsQVwE",A.MAPTILER_API_KEY)}}function me(){return A.MAP_STYLE&&A.MAPTILER_API_KEY}function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function be(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ke(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?be(Object(r),!0).forEach((function(e){Ee(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ee(t,e,r){return(e=Oe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xe(){xe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==we(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(we(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function _e(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Se(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_e(i,n,o,a,u,"next",t)}function u(t){_e(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oe(n.key),n)}}function Oe(t){var e=function(t){if("object"!=we(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==we(e)?e:e+""}var je=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"init",value:(u=Se(xe().mark((function t(){var e,r,n,o,i,a;return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isPushSupported()){t.next=3;break}return console.log("Push notification tidak didukung oleh browser"),t.abrupt("return",{success:!1,message:"Push notification tidak didukung oleh browser"});case 3:return t.prev=3,t.next=6,navigator.serviceWorker.ready;case 6:return e=t.sent,console.log("ServiceWorker siap untuk push notification"),t.next=10,this.ensurePermission();case 10:if(t.sent){t.next=14;break}return console.log("Izin notifikasi tidak diberikan"),t.abrupt("return",{success:!1,message:"Izin notifikasi tidak diberikan. Silakan izinkan notifikasi di pengaturan browser."});case 14:if(console.log("VAPID Public Key:",A.VAPID_PUBLIC_KEY),t.prev=15,r=this._urlBase64ToUint8Array(A.VAPID_PUBLIC_KEY),console.log("Application Server Key:",r,"Length:",r.length),65===r.length){t.next=20;break}throw new Error("Kunci VAPID tidak valid: panjang Uint8Array harus 65 byte");case 20:t.next=26;break;case 22:return t.prev=22,t.t0=t.catch(15),console.error("Gagal mengonversi kunci VAPID:",t.t0),t.abrupt("return",{success:!1,message:"Kunci VAPID tidak valid"});case 26:return t.next=28,e.pushManager.getSubscription();case 28:if(!(n=t.sent)){t.next=32;break}return console.log("Sudah berlangganan push notification:",n),t.abrupt("return",{success:!0,message:"Sudah berlangganan notifikasi"});case 32:return console.log("Membuat langganan push baru..."),t.next=35,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r});case 35:if(o=t.sent,console.log("Langganan push berhasil dibuat:",o),i=wt.getToken()){t.next=41;break}return console.log("Token autentikasi tidak ditemukan"),t.abrupt("return",{success:!1,message:"Silakan login untuk berlangganan notifikasi"});case 41:return console.log("Mengirim langganan ke server..."),t.next=44,vt.subscribePushNotification(i,o);case 44:if(!(a=t.sent).error){t.next=47;break}throw new Error(a.message||"Gagal berlangganan notifikasi");case 47:return console.log("Berlangganan push notification berhasil"),t.abrupt("return",{success:!0,message:"Berlangganan notifikasi berhasil"});case 51:return t.prev=51,t.t1=t.catch(3),console.error("Gagal mengatur push notification:",t.t1),console.error("Detail error:",t.t1.name,t.t1.message,t.t1.stack),t.abrupt("return",{success:!1,message:"Gagal mengatur notifikasi: ".concat(t.t1.message)});case 56:case"end":return t.stop()}}),t,this,[[3,51],[15,22]])}))),function(){return u.apply(this,arguments)})},{key:"unsubscribe",value:(a=Se(xe().mark((function t(){var e,r,n,o;return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isPushSupported()){t.next=3;break}return console.log("Push notification tidak didukung oleh browser"),t.abrupt("return",{success:!1,message:"Push notification tidak didukung oleh browser"});case 3:return t.prev=3,t.next=6,navigator.serviceWorker.ready;case 6:return e=t.sent,t.next=9,e.pushManager.getSubscription();case 9:if(r=t.sent){t.next=13;break}return console.log("Tidak ada langganan push untuk dibatalkan"),t.abrupt("return",{success:!0,message:"Tidak ada langganan untuk dibatalkan"});case 13:if(n=wt.getToken()){t.next=17;break}return console.log("Token autentikasi tidak ditemukan"),t.abrupt("return",{success:!1,message:"Silakan login untuk membatalkan langganan notifikasi"});case 17:return console.log("Mengirim permintaan unsubscribe ke server..."),t.next=20,vt.unsubscribePushNotification(n,r);case 20:if(!(o=t.sent).error){t.next=23;break}throw new Error(o.message||"Gagal membatalkan langganan notifikasi");case 23:return t.next=25,r.unsubscribe();case 25:return console.log("Langganan push berhasil dibatalkan"),t.abrupt("return",{success:!0,message:"Berhasil membatalkan langganan notifikasi"});case 29:return t.prev=29,t.t0=t.catch(3),console.error("Gagal membatalkan langganan push:",t.t0),t.abrupt("return",{success:!1,message:"Gagal membatalkan notifikasi: ".concat(t.t0.message)});case 33:case"end":return t.stop()}}),t,this,[[3,29]])}))),function(){return a.apply(this,arguments)})},{key:"showNotification",value:(i=Se(xe().mark((function t(e){var r,n,o,i,a,u;return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.title,n=void 0===r?"Story berhasil dibuat":r,o=e.options,i=void 0===o?{}:o,this._isPushSupported()){t.next=4;break}return console.log("Push notification tidak didukung"),t.abrupt("return",{success:!1,message:"Push notification tidak didukung oleh browser"});case 4:return t.prev=4,t.next=7,this.ensurePermission();case 7:if(t.sent){t.next=11;break}return console.log("Izin notifikasi tidak diberikan"),t.abrupt("return",{success:!1,message:"Izin notifikasi tidak diberikan. Silakan izinkan notifikasi di pengaturan browser."});case 11:return t.next=13,navigator.serviceWorker.ready;case 13:return a=t.sent,u={body:i.body||"Anda telah membuat story baru dengan deskripsi: Tidak ada deskripsi.",icon:"/images/logo.png",vibrate:[200,100,200]},t.next=17,a.showNotification(n,ke(ke({},u),i));case 17:return console.log("Notifikasi ditampilkan"),t.abrupt("return",{success:!0,message:"Notifikasi ditampilkan"});case 21:return t.prev=21,t.t0=t.catch(4),console.error("Gagal menampilkan notifikasi:",t.t0),t.abrupt("return",{success:!1,message:"Gagal menampilkan notifikasi: ".concat(t.t0.message)});case 25:case"end":return t.stop()}}),t,this,[[4,21]])}))),function(t){return i.apply(this,arguments)})},{key:"_requestNotificationPermission",value:(o=Se(xe().mark((function t(){return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("granted"!==Notification.permission){t.next=2;break}return t.abrupt("return","granted");case 2:return t.next=4,Notification.requestPermission();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"_isPushSupported",value:function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}},{key:"_urlBase64ToUint8Array",value:function(t){try{for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}catch(t){throw new Error("Gagal mengonversi base64 ke Uint8Array: ".concat(t.message))}}},{key:"checkPermissionStatus",value:(n=Se(xe().mark((function t(){return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isPushSupported()){t.next=2;break}return t.abrupt("return",{hasPermission:!1,status:"not-supported"});case 2:return t.abrupt("return",{hasPermission:"granted"===Notification.permission,status:Notification.permission});case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"ensurePermission",value:(r=Se(xe().mark((function t(){var e;return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkPermissionStatus();case 2:if(t.sent.hasPermission){t.next=9;break}return t.next=7,this._requestNotificationPermission();case 7:return e=t.sent,t.abrupt("return","granted"===e);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&Pe(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u}();const Te=je;function Le(t){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(t)}function Ie(){Ie=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Le(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Le(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ae(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ge(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ae(i,n,o,a,u,"next",t)}function u(t){Ae(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Me(n.key),n)}}function Me(t){var e=function(t){if("object"!=Le(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Le(e)?e:e+""}var Fe=function(){return t=function t(e){var r=e.view;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._photoFile=null,this._location=null,this._cameraStream=null},e=[{key:"init",value:(i=Ge(Ie().mark((function t(){var e;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._view.initElements(),this._setupFormSubmit(),this._setupCamera(),this._setupMap(),t.next=6,Te.init();case 6:e={getUserMediaSupported:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),videoElementSupported:!!document.createElement("video").canPlayType,enumerateDevicesSupported:!(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)},console.log("Camera support info:",e),e.getUserMediaSupported||this._view.showCameraStatus("Browser Anda tidak mendukung akses kamera",!0);case 9:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_setupFormSubmit",value:function(){var t=this;this._view.bindFormSubmit(function(){var e=Ge(Ie().mark((function e(r){var n,o,i,a,u,s,c;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=t._view.getDescriptionValue(),t._photoFile){e.next=5;break}return t._view.showError("Silakan ambil foto terlebih dahulu"),e.abrupt("return");case 5:return e.prev=5,t._view.showLoading(),e.next=9,ce();case 9:if(!(o=e.sent)){e.next=16;break}return e.next=13,fe(o,{description:n,photo:t._photoFile,lat:null===(a=t._location)||void 0===a?void 0:a.lat,lon:null===(u=t._location)||void 0===u?void 0:u.lon});case 13:i=e.sent,e.next=19;break;case 16:return e.next=18,pe({description:n,photo:t._photoFile,lat:null===(s=t._location)||void 0===s?void 0:s.lat,lon:null===(c=t._location)||void 0===c?void 0:c.lon});case 18:i=e.sent;case 19:console.log("API Response:",i),i.error?t._view.showError(i.message):(console.log("Skipping notification, redirecting to home..."),t._view.redirectToHome()),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),t._view.showError(e.t0.message);case 26:return e.prev=26,t._view.hideLoading(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[5,23,26,29]])})));return function(t){return e.apply(this,arguments)}}())}},{key:"_setupCamera",value:function(){var t=this;this._view.bindCaptureButtonClick(Ge(Ie().mark((function e(){return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t._view.startCamera();case 3:t._cameraStream=e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),this._view.bindRetakeButtonClick(Ge(Ie().mark((function e(){return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t._photoFile=null,t._view.resetPhoto(),e.next=5,t._view.startCamera();case 5:t._cameraStream=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t._view.showError("Gagal mengambil ulang foto");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))),this._view.bindCapturePhotoButtonClick(Ge(Ie().mark((function e(){return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t._view.capturePhoto();case 3:return t._photoFile=e.sent,e.next=6,t._stopCameraStream();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t._view.showError("Gagal mengambil foto");case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))}},{key:"_stopCameraStream",value:(o=Ge(Ie().mark((function t(){return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._view.stopCameraStream(this._cameraStream),this._cameraStream=null;case 2:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_setupMap",value:function(){var t=this;me()?(this._view.initMap(ge()),this._view.bindMapEvents((function(e,r){t._updateLocationData(e,r)})),this._view.bindLocationToggleChange(function(){var e=Ge(Ie().mark((function e(r){return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.target.checked?(t._view.showLocationOptions(),t._view._elements.locationTypeAuto.checked&&t._getCurrentLocation()):(t._view.hideLocationOptions(),t._location=null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._view.bindLocationTypeAutoChange(Ge(Ie().mark((function e(){return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._view._elements.locationTypeAuto.checked&&t._getCurrentLocation();case 1:case"end":return e.stop()}}),e)})))),this._view.bindLocationSearchButtonClick(function(){var e=Ge(Ie().mark((function e(r){var n;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),n=t._view.getLocationSearchQuery(),t._searchLocation(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._view.bindLocationSearchInputKeypress(function(){var e=Ge(Ie().mark((function e(r){var n;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"===r.key&&(r.preventDefault(),n=t._view.getLocationSearchQuery(),t._searchLocation(n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):console.warn("Map configuration is incomplete")}},{key:"_getCurrentLocation",value:(n=Ge(Ie().mark((function t(){var e,r,n;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._view.getCurrentLocation();case 3:e=t.sent,r=e.lat,n=e.lon,this._updateLocationData(r,n),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return n.apply(this,arguments)})},{key:"_searchLocation",value:(r=Ge(Ie().mark((function t(e){var r,n,o,i;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,ye(e);case 4:(r=t.sent)&&r.length>0?(n=r[0],o=n.lat,i=n.lon,this._view.updateMapPosition(parseFloat(o),parseFloat(i)),this._updateLocationData(parseFloat(o),parseFloat(i)),this._view._elements.locationTypeManual.checked=!0):this._view.showError("Lokasi tidak ditemukan, coba kata kunci lain"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showError("Terjadi kesalahan saat mencari lokasi");case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[0,8,11,14]])}))),function(t){return r.apply(this,arguments)})},{key:"_updateLocationData",value:function(t,e){this._location={lat:t,lon:e},this._view.updateLocationInputs(t,e),this._view.updateCoordinatesDisplay(t,e)}},{key:"getViewTemplate",value:function(){return this._view.getTemplate()}}],e&&Ne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();const Ce=Fe;function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function De(){De=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Be(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Be(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Re(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ue(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Re(i,n,o,a,u,"next",t)}function u(t){Re(i,n,o,a,u,"throw",t)}a(void 0)}))}}function He(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ye(n.key),n)}}function Ye(t){var e=function(t){if("object"!=Be(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Be(e)?e:e+""}const Ve=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new oe,this._presenter=new Ce({view:this._view,model:o})},e=[{key:"render",value:(n=Ue(De().mark((function t(){return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._presenter.getViewTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Ue(De().mark((function t(){return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._presenter.init();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&He(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function We(){We=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Ke(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ke(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ze(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Je(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qe(n.key),n)}}function qe(t){var e=function(t){if("object"!=Ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ke(e)?e:e+""}var Qe=function(){return t=function t(e){var r=e.view,n=e.detailModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._detailModel=n,this._story=null},e=[{key:"getViewTemplate",value:function(){return this._view.getTemplate()}},{key:"showStory",value:(r=We().mark((function t(e){var r,n,o;return We().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log("Showing story with ID: ".concat(e)),e){t.next=6;break}return console.error("Story ID is missing or invalid"),this._view.showError("ID cerita tidak valid."),t.abrupt("return");case 6:return this._view.showLoading(),t.next=9,this._detailModel.getAuthToken();case 9:if(r=t.sent){t.next=15;break}return console.error("No authentication token found"),this._view.showError("Anda harus login untuk melihat detail cerita."),this._redirectToLoginWithDelay(2e3),t.abrupt("return");case 15:return console.log("Fetching story detail from API..."),t.next=18,this._detailModel.fetchStoryDetail(r,e);case 18:(n=t.sent).error?(console.error("API error:",n.message),this._view.showError(n.message||"Gagal memuat detail cerita"),(null!==(o=n.message)&&void 0!==o&&o.toLowerCase().includes("token")||401===n.status)&&(this._view.showError("Sesi Anda telah berakhir. Silakan login kembali."),this._redirectToLoginWithDelay(2e3))):(console.log("Story detail fetched successfully"),this._story=n.story,this._view.showStory(this._story),this._story.lat&&this._story.lon&&this._renderMapIfAvailable()),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),console.error("Error in showStory:",t.t0),this._view.showError(t.t0.message||"Terjadi kesalahan saat memuat detail cerita");case 26:t.prev=26;try{this._view.hideLoading()}catch(t){console.error("Error in hideLoading:",t)}return t.finish(26);case 29:case"end":return t.stop()}}),t,this,[[0,22,26,29]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){ze(i,n,o,a,u,"next",t)}function u(t){ze(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})},{key:"_renderMapIfAvailable",value:function(){if(this._isMapLibraryAvailable())if(this._detailModel.isMapConfigValid()){var t=this._detailModel.getMapConfig();this._view.renderMap(this._story.lat,this._story.lon,t)}else console.warn("Map configuration is incomplete");else console.warn("MapLibre GL JS is not available")}},{key:"_isMapLibraryAvailable",value:function(){return"undefined"!=typeof maplibregl}},{key:"_redirectToLoginWithDelay",value:function(t){this._view.redirectWithDelay(t)}}],e&&Je(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const Xe=Qe;function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tr(n.key),n)}}function tr(t){var e=function(t){if("object"!=$e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$e(e)?e:e+""}const er=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getTemplate",value:function(){return'\n      <section class="detail-section">\n        <div class="back-button-container">\n          <a href="/" class="back-button" id="back-button">\n        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <path d="M19 12H5M12 19l-7-7 7-7"/>\n        </svg>\n            Kembali ke Home\n          </a>\n        </div>\n        <div class="detail-container" id="detail-container">\n          <div class="loading-container" id="loading-container"></div>\n          <div id="error-message" class="error-message"></div>\n        </div>\n      </section>\n    '}},{key:"showStory",value:function(t){var e=document.getElementById("detail-container");e?(e.innerHTML='\n      <img src="'.concat(t.photoUrl,'" alt="').concat(t.name,'\'s story" class="detail-image">\n      <h2 class="detail-title">').concat(t.name,'</h2>\n      <p class="detail-description">').concat(t.description,'</p>\n      <div class="detail-meta">\n        <span>').concat(w(t.createdAt),"</span>\n      </div>\n      ").concat(t.lat&&t.lon?'\n        <div class="story-map" id="story-map" data-lat="'.concat(t.lat,'" data-lon="').concat(t.lon,'"></div>\n      '):"",'\n      <div class="loading-container" id="loading-container"></div>\n      <div id="error-message" class="error-message"></div>\n    '),this._initBackButton()):console.error("Detail container not found")}},{key:"_initBackButton",value:function(){var t=document.getElementById("back-button");t&&"function"==typeof document.startViewTransition&&t.addEventListener("click",(function(t){t.preventDefault(),document.startViewTransition((function(){window.location.href="/"}))}))}},{key:"renderMap",value:function(t,e,r){var n=document.getElementById("story-map");if(n)try{var o=new maplibregl.Map({container:n,style:r.style,center:[e,t],zoom:12});zt(o,[e,t],"<h3>Story</h3><p>Koordinat: ".concat(t.toFixed(6),", ").concat(e.toFixed(6),"</p>")),o.on("styleimagemissing",(function(t){console.log("Missing image:",t.id),o.addImage(t.id,new Image(1,1))}))}catch(t){console.error("Error rendering map:",t),n&&(n.innerHTML='<div class="map-error">Gagal memuat peta</div>')}}},{key:"showLoading",value:function(){var t=document.getElementById("loading-container");t?t.innerHTML='<div class="loading-spinner"></div>':console.warn("Loading container not found when trying to show loading")}},{key:"hideLoading",value:function(){var t=document.getElementById("loading-container");t?t.innerHTML="":console.warn("Loading container not found when trying to hide loading")}},{key:"showError",value:function(t){var e=document.getElementById("error-message");e?e.textContent=t:console.warn("Error message element not found")}},{key:"redirectToLogin",value:function(){window.location.href="/auth/login"}},{key:"redirectWithDelay",value:function(t){var e=this;setTimeout((function(){e.redirectToLogin()}),t)}}],e&&Ze(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function nr(){nr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==rr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(rr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function or(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ir(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){or(i,n,o,a,u,"next",t)}function u(t){or(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ar(){return ur.apply(this,arguments)}function ur(){return(ur=ir(nr().mark((function t(){return nr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",wt.getToken());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function sr(t,e){return cr.apply(this,arguments)}function cr(){return cr=ir(nr().mark((function t(e,r){return nr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt.getStoryDetail(e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),cr.apply(this,arguments)}function lr(){return{style:A.MAP_STYLE.replace("UF8IB6hcumzoX6wsQVwE",A.MAPTILER_API_KEY)}}function fr(){return A.MAP_STYLE&&A.MAPTILER_API_KEY}function hr(t){var e=t.startsWith("/")?t.substring(1):t;if(e.startsWith("auth/")){var r=e.split("/");if(r.length>=2)return{resource:"auth/".concat(r[1]),id:null}}if(e.startsWith("detail/")){var n=e.split("/");if(n.length>=2)return{resource:"detail",id:n[1]}}var o=e.split("/").filter((function(t){return t}));return 0===o.length?{resource:null,id:null}:1===o.length?{resource:o[0],id:null}:{resource:o[0],id:o[1]}}function pr(t){if(!t.resource)return"/";if(t.resource.startsWith("auth/"))return"/".concat(t.resource);var e="/".concat(t.resource);return t.id&&(e=e.concat("/:id")),e}function vr(){var t=location.pathname||"/";return t.startsWith("/")?t:"/".concat(t)}function yr(){try{var t=vr(),e=hr(t);return console.log("Pathname:",t),console.log("URL Segments:",e),console.log("Constructed Route:",pr(e)),pr(e)}catch(t){return console.error("Error in getActiveRoute:",t),"/"}}function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function gr(){gr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==dr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(dr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function mr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function wr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){mr(i,n,o,a,u,"next",t)}function u(t){mr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function br(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kr(n.key),n)}}function kr(t){var e=function(t){if("object"!=dr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=dr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dr(e)?e:e+""}const Er=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new er,this._presenter=new Xe({view:this._view,detailModel:i})},e=[{key:"render",value:(n=wr(gr().mark((function t(){return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._presenter.getViewTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=wr(gr().mark((function t(){var e,r;return gr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=hr(vr()),r=e.id,t.next=3,this._presenter.showStory(r);case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&br(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function xr(t){return xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(t)}function _r(){_r=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==xr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(xr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Sr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Pr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Sr(i,n,o,a,u,"next",t)}function u(t){Sr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jr(n.key),n)}}function jr(t){var e=function(t){if("object"!=xr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xr(e)?e:e+""}const Tr=function(){return t=function t(e){var r=e.view,n=e.loginModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._loginModel=n},e=[{key:"getViewTemplate",value:function(){return this._view.getTemplate()}},{key:"init",value:(n=Pr(_r().mark((function t(){return _r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loginModel.getAuthToken();case 2:if(!t.sent){t.next=6;break}return this._view.redirectToHome(),t.abrupt("return");case 6:this._view.bindFormSubmit(this._handleLogin.bind(this));case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_handleLogin",value:(r=Pr(_r().mark((function t(e){var r;return _r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,this._loginModel.loginUser(e);case 4:if((r=t.sent).error){t.next=11;break}return t.next=8,this._loginModel.storeUserData(r.loginResult.token,{userId:r.loginResult.userId,name:r.loginResult.name});case 8:this._view.redirectToHome(),t.next=12;break;case 11:this._view.showError(r.message);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),this._view.showError(t.t0.message);case 17:return t.prev=17,this._view.hideLoading(),t.finish(17);case 20:case"end":return t.stop()}}),t,this,[[0,14,17,20]])}))),function(t){return r.apply(this,arguments)})}],e&&Or(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Lr(t){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lr(t)}function Ir(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ar(n.key),n)}}function Ar(t){var e=function(t){if("object"!=Lr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lr(e)?e:e+""}const Gr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getTemplate",value:function(){return'\n      <section class="auth-section">\n        <div class="auth-container">\n          <h2 class="auth-title">Login</h2>\n          <form id="login-form" class="auth-form">\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input type="email" id="email" required>\n            </div>\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input type="password" id="password" required minlength="8">\n            </div>\n            <button type="submit" class="auth-button">Login</button>\n          </form>\n          <p class="auth-link">Belum punya akun? <a href="/auth/register">Daftar disini</a></p>\n          <div id="loading-container" class="loading-container"></div>\n          <div id="error-message" class="error-message"></div>\n        </div>\n      </section>\n    '}},{key:"bindFormSubmit",value:function(t){var e=this;document.getElementById("login-form").addEventListener("submit",(function(r){r.preventDefault();var n=e.getFormData();t(n)}))}},{key:"getFormData",value:function(){return{email:document.getElementById("email").value,password:document.getElementById("password").value}}},{key:"showLoading",value:function(){document.getElementById("loading-container").innerHTML='<div class="loading-spinner"></div>'}},{key:"hideLoading",value:function(){document.getElementById("loading-container").innerHTML=""}},{key:"showError",value:function(t){document.getElementById("error-message").textContent=t}},{key:"redirectToHome",value:function(){window.location.href="/"}}],e&&Ir(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function Mr(){Mr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Nr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Nr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Fr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Cr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Fr(i,n,o,a,u,"next",t)}function u(t){Fr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Br(t){return Dr.apply(this,arguments)}function Dr(){return(Dr=Cr(Mr().mark((function t(e){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt.login(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rr(t,e){return Ur.apply(this,arguments)}function Ur(){return Ur=Cr(Mr().mark((function t(e,r){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,at.saveToken(e);case 2:return t.next=4,at.saveUser(r);case 4:case"end":return t.stop()}}),t)}))),Ur.apply(this,arguments)}function Hr(){return Yr.apply(this,arguments)}function Yr(){return(Yr=Cr(Mr().mark((function t(){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",wt.getToken());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Vr(t){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(t)}function Kr(){Kr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Vr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Vr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Wr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function zr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wr(i,n,o,a,u,"next",t)}function u(t){Wr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Jr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qr(n.key),n)}}function qr(t){var e=function(t){if("object"!=Vr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vr(e)?e:e+""}const Qr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new Gr,this._presenter=new Tr({view:this._view,loginModel:a})},e=[{key:"render",value:(n=zr(Kr().mark((function t(){return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._presenter.getViewTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=zr(Kr().mark((function t(){return Kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._presenter.init();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&Jr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Xr(t){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(t)}function $r(){$r=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Xr(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Xr(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Zr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function tn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Zr(i,n,o,a,u,"next",t)}function u(t){Zr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function en(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rn(n.key),n)}}function rn(t){var e=function(t){if("object"!=Xr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Xr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xr(e)?e:e+""}const nn=function(){return t=function t(e){var r=e.view,n=e.registerModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._registerModel=n},e=[{key:"getViewTemplate",value:function(){return this._view.getTemplate()}},{key:"init",value:(n=tn($r().mark((function t(){return $r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._registerModel.getAuthToken();case 2:if(!t.sent){t.next=6;break}return this._view.redirectToHome(),t.abrupt("return");case 6:this._view.bindFormSubmit(this._handleRegister.bind(this));case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_handleRegister",value:(r=tn($r().mark((function t(e){var r;return $r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,this._registerModel.registerUser(e);case 4:(r=t.sent).error?this._view.showError(r.message):(this._view.showSuccess("Registrasi berhasil! Silakan login."),this._redirectToLoginWithDelay(2e3)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showError(t.t0.message||"Terjadi kesalahan saat registrasi");case 11:return t.prev=11,this._view.hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[0,8,11,14]])}))),function(t){return r.apply(this,arguments)})},{key:"_redirectToLoginWithDelay",value:function(t){this._view.redirectWithDelay(t)}}],e&&en(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function on(t){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},on(t)}function an(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,un(n.key),n)}}function un(t){var e=function(t){if("object"!=on(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=on(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==on(e)?e:e+""}const sn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getTemplate",value:function(){return'\n      <section class="auth-section">\n        <div class="auth-container">\n          <h2 class="auth-title">Daftar Akun</h2>\n          <form id="register-form" class="auth-form">\n            <div class="form-group">\n              <label for="name">Nama</label>\n              <input type="text" id="name" required>\n            </div>\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input type="email" id="email" required>\n            </div>\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input type="password" id="password" required minlength="8">\n            </div>\n            <button type="submit" class="auth-button">Daftar</button>\n          </form>\n          <p class="auth-link">Sudah punya akun? <a href="/auth/login">Login disini</a></p>\n          <div id="loading-container" class="loading-container"></div>\n          <div id="error-message" class="error-message"></div>\n          <div id="success-message" class="success-message"></div>\n        </div>\n      </section>\n    '}},{key:"bindFormSubmit",value:function(t){var e=this,r=document.getElementById("register-form");r&&r.addEventListener("submit",(function(r){r.preventDefault();var n=e.getFormData();t(n)}))}},{key:"getFormData",value:function(){var t,e,r;return{name:(null===(t=document.getElementById("name"))||void 0===t?void 0:t.value)||"",email:(null===(e=document.getElementById("email"))||void 0===e?void 0:e.value)||"",password:(null===(r=document.getElementById("password"))||void 0===r?void 0:r.value)||""}}},{key:"showLoading",value:function(){var t=document.getElementById("loading-container");t&&(t.innerHTML='<div class="loading-spinner"></div>')}},{key:"hideLoading",value:function(){var t=document.getElementById("loading-container");t&&(t.innerHTML="")}},{key:"showError",value:function(t){var e=document.getElementById("error-message");e&&(e.textContent=t,e.style.color="var(--danger-color)")}},{key:"showSuccess",value:function(t){var e=document.getElementById("success-message");e&&(e.textContent=t,e.style.color="var(--success-color)")}},{key:"redirectWithDelay",value:function(t){var e=this;setTimeout((function(){e.redirectToLogin()}),t)}},{key:"redirectToHome",value:function(){window.location.href="/"}},{key:"redirectToLogin",value:function(){window.location.href="/auth/login"}}],e&&an(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function cn(t){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cn(t)}function ln(){ln=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==cn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(cn(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function fn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function hn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){fn(i,n,o,a,u,"next",t)}function u(t){fn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function pn(){return vn.apply(this,arguments)}function vn(){return(vn=hn(ln().mark((function t(){return ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",wt.getToken());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yn(t){return dn.apply(this,arguments)}function dn(){return(dn=hn(ln().mark((function t(e){return ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt.register(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function mn(){mn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==gn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(gn(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function wn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function bn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){wn(i,n,o,a,u,"next",t)}function u(t){wn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function kn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,En(n.key),n)}}function En(t){var e=function(t){if("object"!=gn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=gn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gn(e)?e:e+""}const xn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new sn,this._presenter=new nn({view:this._view,registerModel:u})},e=[{key:"render",value:(n=bn(mn().mark((function t(){return mn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._presenter.getViewTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=bn(mn().mark((function t(){return mn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._presenter.init();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&kn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function _n(t){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(t)}function Sn(){Sn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==_n(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_n(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Pn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function On(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Pn(i,n,o,a,u,"next",t)}function u(t){Pn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function jn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tn(n.key),n)}}function Tn(t){var e=function(t){if("object"!=_n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_n(e)?e:e+""}const Ln=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=On(Sn().mark((function t(){return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <div class="error-container">\n        <h2>404 - Halaman Tidak Ditemukan</h2>\n        <p>Maaf, halaman yang Anda cari tidak dapat ditemukan.</p>\n          <a href="#/" class="button">Back to Home</a>\n      </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=On(Sn().mark((function t(){return Sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&jn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}(),In={"/":new Bt,"/about":new Wt,"/add":new Ve,"/detail/:id":new Er,"/auth/login":new Qr,"/auth/register":new xn,"/404":new Ln};function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function Gn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nn(n.key),n)}}function Nn(t){var e=function(t){if("object"!=An(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=An(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==An(e)?e:e+""}const Mn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"init",value:function(t){var e=t.drawer,r=t.button;r.addEventListener("click",(function(){e.classList.toggle("open")})),document.body.addEventListener("click",(function(t){e.contains(t.target)||r.contains(t.target)||e.classList.remove("open"),e.querySelectorAll("a").forEach((function(r){r.contains(t.target)&&e.classList.remove("open")}))}))}}],null&&Gn(t.prototype,null),e&&Gn(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function Cn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bn(n.key),n)}}function Bn(t){var e=function(t){if("object"!=Fn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fn(e)?e:e+""}const Dn=function(){return t=function t(e){var r=e.skipLink,n=e.mainContent;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._skipLink=r,this._mainContent=n},(e=[{key:"init",value:function(){this._registerEvent()}},{key:"_registerEvent",value:function(){var t=this;this._skipLink.addEventListener("click",(function(e){e.preventDefault(),t._skipLink.blur();var r=window.location.hash;"#/auth/login"===r?setTimeout((function(){var e=document.getElementById("email");e?(e.focus(),console.log("Skip to email input activated")):(t._focusMainContent(),console.log("Email input not found, focusing main content instead"))}),100):"#/auth/register"===r?setTimeout((function(){var e=document.getElementById("name");e?(e.focus(),console.log("Skip to name input activated")):(t._focusMainContent(),console.log("Name input not found, focusing main content instead"))}),100):(t._focusMainContent(),console.log("Skip to content activated"))}))}},{key:"_focusMainContent",value:function(){this._mainContent.setAttribute("tabindex","-1"),this._mainContent.focus(),this._mainContent.scrollIntoView({behavior:"smooth"})}}])&&Cn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function Un(){Un=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==Rn(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Rn(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Hn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Yn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Hn(i,n,o,a,u,"next",t)}function u(t){Hn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Vn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kn(n.key),n)}}function Kn(t){var e=function(t){if("object"!=Rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rn(e)?e:e+""}const Wn=function(){return t=function t(e){var r=e.navigationDrawer,n=e.drawerButton,o=e.content;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._navigationDrawer=r,this._drawerButton=n,this._content=o,this._isLoadingPage=!1,this._currentRenderedPath=null,this._skipLink=document.querySelector(".skip-link"),this._initializeApp()},e=[{key:"_initializeApp",value:(a=Yn(Un().mark((function t(){return Un().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Mn.init({drawer:this._navigationDrawer,button:this._drawerButton}),this._initSkipContent(),this._setupLogout(),t.next=5,this._updateNavigationBasedOnAuth();case 5:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"_initSkipContent",value:function(){new Dn({skipLink:this._skipLink,mainContent:this._content}).init()}},{key:"_setupLogout",value:function(){var t=this,e=document.getElementById("logout-link");e&&e.addEventListener("click",function(){var e=Yn(Un().mark((function e(r){return Un().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,wt.logout();case 3:return e.next=5,t._updateNavigationBasedOnAuth();case 5:window.location.href="/auth/login";case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_updateNavigationBasedOnAuth",value:(i=Yn(Un().mark((function t(){var e,r,n,o,i;return Un().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,wt.isAuthenticated();case 3:if(e=t.sent,r=document.getElementById("nav-list")){t.next=7;break}return t.abrupt("return");case 7:n=document.getElementById("logout-link"),o=!1,n&&(i=n.cloneNode(!0),n.parentNode&&n.parentNode.replaceChild(i,n),o=!0),e?o||(r.innerHTML='\n            <li><a href="/">Beranda</a></li>\n            <li><a href="/add">Tambah Story</a></li>\n            <li><a href="/about">Tentang</a></li>\n            <li><a href="" id="logout-link">Logout</a></li>\n          ',this._setupLogout()):o&&(r.innerHTML='\n            <li><a href="/auth/login">Login</a></li>\n            <li><a href="/auth/register">Register</a></li>\n            <li><a href="/about">Tentang</a></li>\n          '),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.error("Error updating navigation:",t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(){return i.apply(this,arguments)})},{key:"renderPage",value:(o=Yn(Un().mark((function t(){var e,r=this;return Un().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoadingPage){t.next=3;break}return console.log("Page is already loading, skipping render"),t.abrupt("return");case 3:if(e=window.location.href,this._currentRenderedPath!==e){t.next=7;break}return console.log("Same path, no need to re-render:",e),t.abrupt("return");case 7:return this._isLoadingPage=!0,console.log("Starting page render for path:",e),t.prev=9,t.next=12,this._updateNavigationBasedOnAuth();case 12:if(document.startViewTransition){t.next=17;break}return t.next=15,this._loadPage();case 15:t.next=19;break;case 17:return t.next=19,document.startViewTransition((function(){return r._loadPage()})).finished;case 19:this._currentRenderedPath=e,t.next=27;break;case 22:return t.prev=22,t.t0=t.catch(9),console.error("Error during page transition:",t.t0),t.next=27,this._loadPage();case 27:return t.prev=27,this._isLoadingPage=!1,console.log("Page render complete for:",e),t.finish(27);case 31:case"end":return t.stop()}}),t,this,[[9,22,27,31]])}))),function(){return o.apply(this,arguments)})},{key:"_loadPage",value:(n=Yn(Un().mark((function t(){var e,r,n,o,i,a,u;return Un().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=yr(),console.log("Loading page for route:",e),(r=In[e])||(n=window.location.href.slice(1),console.log("Route not found, trying pathname directly:",n),"/auth/login"===n?r=In["/auth/login"]:"/auth/register"===n?r=In["/auth/register"]:"/about"===n?r=In["/about"]:"/"!==n&&""!==n||(r=In["/"])),r){t.next=18;break}if(console.log("Page not found, showing 404 page"),!(o=In["/404"])){t.next=16;break}return t.next=11,o.render();case 11:return this._content.innerHTML=t.sent,t.next=14,o.afterRender();case 14:t.next=17;break;case 16:this._content.innerHTML='<div class="error-container">Halaman tidak ditemukan</div>';case 17:return t.abrupt("return");case 18:if("function"==typeof r.render){t.next=31;break}if(console.error("Page does not have a render method:",e),!(i=In["/404"])){t.next=29;break}return t.next=24,i.render();case 24:return this._content.innerHTML=t.sent,t.next=27,i.afterRender();case 27:t.next=30;break;case 29:this._content.innerHTML='<div class="error-container">Struktur halaman tidak valid</div>';case 30:return t.abrupt("return");case 31:return t.next=33,r.render();case 33:if(a=t.sent,this._content.innerHTML=a,"function"!=typeof r.afterRender){t.next=38;break}return t.next=38,r.afterRender();case 38:t.next=60;break;case 40:if(t.prev=40,t.t0=t.catch(0),console.error("Error loading page:",t.t0),t.prev=43,!(u=In["/404"])){t.next=53;break}return t.next=48,u.render();case 48:return this._content.innerHTML=t.sent,t.next=51,u.afterRender();case 51:t.next=54;break;case 53:this._content.innerHTML='<div class="error-container">Terjadi kesalahan saat memuat halaman</div>';case 54:t.next=60;break;case 56:t.prev=56,t.t1=t.catch(43),console.error("Error showing 404 page:",t.t1),this._content.innerHTML='<div class="error-container">Terjadi kesalahan</div>';case 60:case 61:case"end":return t.stop()}}),t,this,[[0,40],[43,56]])}))),function(){return n.apply(this,arguments)})}],e&&Vn(t.prototype,e),r&&Vn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();var zn=r(72),Jn=r.n(zn),qn=r(825),Qn=r.n(qn),Xn=r(659),$n=r.n(Xn),Zn=r(56),to=r.n(Zn),eo=r(540),ro=r.n(eo),no=r(113),oo=r.n(no),io=r(177),ao={};function uo(t){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(t)}function so(){so=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function v(){}var y={};s(y,i,(function(){return this}));var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=v.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==uo(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(uo(e)+" is not iterable")}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function co(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function lo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){co(i,n,o,a,u,"next",t)}function u(t){co(i,n,o,a,u,"throw",t)}a(void 0)}))}}ao.styleTagTransform=oo(),ao.setAttributes=to(),ao.insert=$n().bind(null,"head"),ao.domAPI=Qn(),ao.insertStyleElement=ro(),Jn()(io.A,ao),io.A&&io.A.locals&&io.A.locals;var fo=!1,ho=null,po=function(){var t=document.getElementById("logout-link");t?(t.addEventListener("click",(function(t){t.preventDefault(),console.log("Logout diklik, melakukan logout..."),wt.logout(),window.location.href="/auth/login",window.location.reload()})),console.log("Logout handler terdaftar")):console.warn("Logout link tidak ditemukan di DOM")},vo=function(){var t=lo(so().mark((function t(){var e;return so().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)){t.next=15;break}return t.prev=1,t.next=4,navigator.serviceWorker.register("/sw.js");case 4:if(e=t.sent,console.log("Service worker terdaftar:",e),navigator.serviceWorker.controller){t.next=9;break}return t.next=9,new Promise((function(t){var e=function(){navigator.serviceWorker.removeEventListener("controllerchange",e),t()};navigator.serviceWorker.addEventListener("controllerchange",e)}));case 9:return t.abrupt("return",e);case 12:t.prev=12,t.t0=t.catch(1),console.error("Gagal mendaftarkan service worker:",t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}(),yo=new Wn({navigationDrawer:document.getElementById("navigation-drawer"),drawerButton:document.getElementById("drawer-button"),content:document.getElementById("main-content")});window.addEventListener("popstate",(function(){var t=window.location.pathname;t!==ho?fo?(console.log("Sedang rendering, menunda render"),ho=t):(fo=!0,ho=t,console.log("Pathname berubah ke:",t),setTimeout((function(){yo.renderPage().finally((function(){fo=!1,po()}))}),10)):console.log("Pathname sama, mengabaikan perubahan")})),window.addEventListener("load",(function(){console.log("Memuat halaman awal..."),fo=!0,yo.renderPage().finally((function(){fo=!1,console.log("Render awal selesai"),po()})),setTimeout(lo(so().mark((function t(){var e,r,n,o,i;return so().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vo();case 2:if(!t.sent){t.next=37;break}return t.next=6,Te.checkPermissionStatus();case 6:if(e=t.sent,console.log("Status izin notifikasi:",e),"denied"!==e.status){t.next=16;break}return console.log("Izin notifikasi diblokir, lewati inisialisasi push notification"),(r=document.createElement("div")).textContent='Notifikasi diblokir. Klik ikon kunci di bilah alamat, pilih "Site settings", dan izinkan notifikasi.',r.style.cssText="color: orange; margin: 10px; text-align: center; font-size: 14px;",document.body.prepend(r),setTimeout((function(){return r.remove()}),5e3),t.abrupt("return");case 16:return t.next=18,Te.init();case 18:if(!(n=t.sent)||n.success){t.next=28;break}console.warn("Gagal mengatur push notification:",n.message),(o=document.createElement("div")).textContent=n.message,o.style.cssText="color: orange; margin: 10px; text-align: center; font-size: 14px;",document.body.prepend(o),setTimeout((function(){return o.remove()}),5e3),t.next=37;break;case 28:if(!n||!n.success){t.next=37;break}return console.log("Push notification berhasil diatur:",n.message),(i=document.createElement("div")).textContent=n.message,i.style.cssText="color: green; margin: 10px; text-align: center; font-size: 14px;",document.body.prepend(i),setTimeout((function(){return i.remove()}),5e3),t.next=37,Te.showNotification({title:"Story berhasil dibuat",options:{body:"Anda telah membuat story baru dengan deskripsi: Selamat datang di Dicoding Story App!"}});case 37:case"end":return t.stop()}}),t)}))),500)})),console.log("Pemeriksaan lingkungan:",{localStorage:!!window.localStorage,fetch:!!window.fetch,baseUrl:A.BASE_URL});var go=wt.getToken();go&&navigator.onLine?(console.log("Menguji API dengan token autentikasi"),fetch("".concat(A.BASE_URL,"/stories"),{headers:{Authorization:"Bearer ".concat(go)}}).then((function(t){console.log("Respon tes API:",t.status),401===t.status&&(console.warn("Token mungkin kedaluwarsa, menghapus token dan mengarahkan ke login"),wt.logout(),window.location.href="/auth/login")})).catch((function(t){return console.error("Error tes API:",t)}))):console.log("User belum login atau offline, melewatkan tes API")})();